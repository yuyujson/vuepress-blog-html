(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{576:function(s,a,t){"use strict";t.r(a);var e=t(29),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"linux-安装-elasticsearch6-4-x"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-安装-elasticsearch6-4-x"}},[s._v("#")]),s._v(" Linux 安装 Elasticsearch6.4.x")]),s._v(" "),t("h2",{attrs:{id:"安装jdk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装jdk"}},[s._v("#")]),s._v(" 安装JDK")]),s._v(" "),t("p",[s._v("es依赖于jdk,服务器上已经安装jdk,略过")]),s._v(" "),t("h2",{attrs:{id:"安装es"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装es"}},[s._v("#")]),s._v(" 安装es")]),s._v(" "),t("h3",{attrs:{id:"_1-下载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载"}},[s._v("#")]),s._v(" 1. 下载")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 创建目录")]),s._v("\ncd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\nmkdir es\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// wget下载")]),s._v("\nwget https"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("artifacts"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("elastic"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("co"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("downloads"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("elasticsearch"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("elasticsearch"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.4")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 解压")]),s._v("\ntar "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("zxvf elasticsearch"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.4")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"_2-修改es配置文件elasticsearch-yml"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改es配置文件elasticsearch-yml"}},[s._v("#")]),s._v(" 2. 修改es配置文件elasticsearch.yml")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("vim /usr/local/es/elasticsearch-6.6.2/config/elasticsearch.yml\n\n------------------------------------\n# 集群名称\ncluster.name: my-es\n# 主机名\nnode.name: node-1\n// 数据文件及日志位置\npath.data: /usr/local/es/elasticsearch-6.6.2/data\npath.logs: /usr/local/es/elasticsearch-6.6.2/logs\n\nbootstrap.memory_lock: false\nbootstrap.system_call_filter: false\n// ip\nnetwork.host: 0.0.0.0\n// 端口号\nhttp.port: 9200\n------------------------------------\n\n:wq\n// 创建配置的数据文件及日志文件目录\ncd /usr/local/es/elasticsearch-6.6.2\nmkdir data\nmkdir logs\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("h3",{attrs:{id:"_3-创建用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-创建用户"}},[s._v("#")]),s._v(" 3. 创建用户")]),s._v(" "),t("p",[s._v("由于Elasticsearch可以接收用户输入的脚本并且执行，为了系统安全考虑，不允许root账号启动，所以建议给Elasticsearch单独创建一个用户来运行Elasticsearch。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('// 创建用户test\nuseradd test\n// 为test分配密码test\necho "password" |passwd test --test\n// 为新创建的用户test分配文件权限\nchown -R test:test /usr/local/es/elasticsearch-6.6.2\n// 验证用户\n1. su test\n2. 输入密码\n3. whoami\n4. 查看输出是否是test\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"_4-使用test用户运行es"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-使用test用户运行es"}},[s._v("#")]),s._v(" 4. 使用test用户运行es")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /usr/local/es/elasticsearch-6.6.2/bin\n./elasticsearch\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[t("strong",[s._v("./elasticsearch -d")]),s._v(" 是后台运行")])]),s._v(" "),t("h3",{attrs:{id:"_5-可能出现的错误"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-可能出现的错误"}},[s._v("#")]),s._v(" 5. 可能出现的错误")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"max-file-descriptors-4096-for-elasticsearch-process-is-too-low"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#max-file-descriptors-4096-for-elasticsearch-process-is-too-low"}},[s._v("#")]),s._v(" max file descriptors [4096] for elasticsearch process is too low")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("max file descriptors [4096] for elasticsearch process is too low, increase to at least [65536]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("原因：无法创建本地文件问题,用户最大可创建文件数太小解决方案：切到root 用户下")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ vim /etc/security/limits.conf 在文件的末尾添加下面的参数值：\n* soft nofile 65536\n* hard nofile 131072\n* soft nproc 2048\n* hard nproc 4096\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("hr"),s._v(" "),t("h4",{attrs:{id:"max-virtual-memory-areas-vm-max-map-count-65530-is-too-low"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#max-virtual-memory-areas-vm-max-map-count-65530-is-too-low"}},[s._v("#")]),s._v(" max virtual memory areas vm.max_map_count [65530] is too low")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ERROR: [1] bootstrap checks failed\n[1]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]\n... ...\n[2018-10-30T11:41:51,807][INFO ][o.e.x.m.j.p.NativeController] Native controller process has stopped - no new native processes can be started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("原因：最大虚拟内存太小,需要修改系统变量的最大值。解决方案：切换到root用户,修改配置sysctl.conf 增加配置值： vm.max_map_count=262144")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ vim /etc/sysctl.conf\nvm.max_map_count=262144\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("hr"),s._v(" "),t("h4",{attrs:{id:"max-number-of-threads-1024-for-user-es-likely-too-low"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#max-number-of-threads-1024-for-user-es-likely-too-low"}},[s._v("#")]),s._v(" max number of threads [1024] for user [es] likely too low")]),s._v(" "),t("p",[s._v("原因：无法创建本地线程问题,用户最大可创建线程数太小解决方案：切换到root用户，进入limits.d目录下，修改90-nproc.conf 配置文件。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("vi /etc/security/limits.d/90-nproc.conf\n找到如下内容：\n* soft nproc 1024\n#修改为\n* soft nproc 2048\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_6-验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-验证"}},[s._v("#")]),s._v(" 6. 验证")]),s._v(" "),t("p",[s._v("本地浏览器输入服务器ip:9200"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/yuyujson/cdn-images@latest/blog-images/20210214154814.png",alt:"image.png"}})])])}),[],!1,null,null,null);a.default=r.exports}}]);